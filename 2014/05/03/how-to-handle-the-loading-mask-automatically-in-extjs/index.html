<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>How to handle the loading mask automatically in ExtJS | Xiaodan&#39;s Everything</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="We know that ajax asynchronous request is being used everywhere in most of the website.But in some situations, other operations are not allowed to create before all the current requests finished.So, i">
<meta property="og:type" content="article">
<meta property="og:title" content="How to handle the loading mask automatically in ExtJS">
<meta property="og:url" content="http://blog.staydan.com/2014/05/03/how-to-handle-the-loading-mask-automatically-in-extjs/index.html">
<meta property="og:site_name" content="Xiaodan's Everything">
<meta property="og:description" content="We know that ajax asynchronous request is being used everywhere in most of the website.But in some situations, other operations are not allowed to create before all the current requests finished.So, i">
<meta property="og:updated_time" content="2015-06-19T01:57:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to handle the loading mask automatically in ExtJS">
<meta name="twitter:description" content="We know that ajax asynchronous request is being used everywhere in most of the website.But in some situations, other operations are not allowed to create before all the current requests finished.So, i">
  
  
  <script src="http://www.staydan.com/libs/jQuery/2.0.3/jquery-2.0.3.min.js"></script>
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div class="container">
    <div class="wrapper">
      <header class="site-header">
  <div id="header-title" class="inner">
    <h1>
      <a href="/" title="Xiaodan's Everything">Xiaodan's Everything</a>
    </h1>
    
      <h4 id="subtitle-wrap">
        <a href="/" title="A foolish Programmer from Shanghai China">A foolish Programmer from Shanghai China</a>
      </h4>
    
  </div>
  <nav id="site-navs" class="">
	  <ul>
      <li class="header-underline"></li>
      
	      <li class="ease-animation header-item-Home"><a href="/" title="Home">Home</a></li>
	    
	      <li class="ease-animation header-item-Archives"><a href="/archives" title="Archives">Archives</a></li>
	    
	      <li class="ease-animation header-item-About"><a href="/about" title="About">About</a></li>
	    
	      <li class="ease-animation header-item-Logs"><a href="/logs" title="Logs">Logs</a></li>
	    
	  </ul>
	  <div class="clearfix"></div>
	</nav>
</header>

      <div class="outer clearfix">
        <section id="main"><section class="tags-selection">
  <header class="tags-selection-header">
    <div class="tags-selection-header-label"><i class="fa fa-tag"></i>Tags</div>
  </header>
  <div id="tags-selection-panel">
  	<div class="tags-selection-navs" title="Sorted by the first English alphabet."><label class="tags-selection-nav active" navid="ad">A - D</label><label class="tags-selection-nav " navid="eh">E - H</label><label class="tags-selection-nav " navid="il">I - L</label><label class="tags-selection-nav " navid="mp">M - P</label><label class="tags-selection-nav " navid="qt">Q - T</label><label class="tags-selection-nav " navid="ux">U - X</label><label class="tags-selection-nav " navid="yz">Y - Z</label></div><div class="tags-selection-content"><div id="tags-selection-content-ad" class="tags-selection-content-part"><a href="/tags/ChromeExtension"><span class="tag-instant" tagid="citf3493x0005gi2srrxt28hu">ChromeExtension<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Chrome Extension"><span class="tag-instant" tagid="citf34946000kgi2sbtmqghg5">Chrome-Extension<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Click Event"><span class="tag-instant" tagid="citf3494k001dgi2saxem59og">Click-Event<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Data Visualization"><span class="tag-instant" tagid="citf3494o001jgi2s7toeodig">Data-Visualization<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/docing"><span class="tag-instant" tagid="citf3494y0024gi2shu5drb9a">docing<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/document"><span class="tag-instant" tagid="citf3494y0025gi2s6dsds4d2">document<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/CSS3"><span class="tag-instant" tagid="citf34951002dgi2ssoszcvgo">CSS3<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Canvas"><span class="tag-instant" tagid="citf34958002pgi2shmkx87ns">Canvas<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Algorithm"><span class="tag-instant" tagid="citf3495d0033gi2sll1o9psu">Algorithm<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/DateFormat"><span class="tag-instant" tagid="citf3495v004egi2sbak20oka">DateFormat<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/CSS"><span class="tag-instant" tagid="citf34960004kgi2smgf7xxfx">CSS<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/AngularJS"><span class="tag-instant" tagid="citf34967004ygi2sbiy7xgd1">AngularJS<sup class="tag-selection-badge">0</sup></span></a><a href="/tags/Bower"><span class="tag-instant" tagid="citf349670050gi2sw7jtuy2h">Bower<sup class="tag-selection-badge">0</sup></span></a></div><div id="tags-selection-content-eh" class="tags-selection-content-part"><a href="/tags/hack"><span class="tag-instant" tagid="citf34944000egi2svlf82lp4">hack<sup class="tag-selection-badge">0</sup></span></a><a href="/tags/Encoding"><span class="tag-instant" tagid="citf3494a000wgi2slci1g78k">Encoding<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Hive Plot"><span class="tag-instant" tagid="citf3494p001kgi2ss3n30o6x">Hive-Plot<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/HTML5"><span class="tag-instant" tagid="citf34951002cgi2s9elgjryn">HTML5<sup class="tag-selection-badge">2</sup></span></a><a href="/tags/History"><span class="tag-instant" tagid="citf34965004ugi2sw26ux13i">History<sup class="tag-selection-badge">0</sup></span></a><a href="/tags/Grunt"><span class="tag-instant" tagid="citf34967004zgi2s783okwt3">Grunt<sup class="tag-selection-badge">0</sup></span></a></div><div id="tags-selection-content-il" class="tags-selection-content-part"><a href="/tags/liqi.io"><span class="tag-instant" tagid="citf34948000ngi2sl7pgstge">liqi-io<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/JavaScript"><span class="tag-instant" tagid="citf3494f0015gi2sx98y8ypx">JavaScript<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/jQuery"><span class="tag-instant" tagid="citf3494h0016gi2svdmk8qlw">jQuery<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/iScrollJs"><span class="tag-instant" tagid="citf3494v001ygi2synveg2l4">iScrollJs<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Jeju"><span class="tag-instant" tagid="citf3495h003fgi2sfj360c9n">Jeju<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/laptop"><span class="tag-instant" tagid="citf3495k003mgi2s78mcyyvv">laptop<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-mp" class="tags-selection-content-part"><a href="/tags/npmjs"><span class="tag-instant" tagid="citf3494a000vgi2s1woim1j5">npmjs<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Pull to refresh"><span class="tag-instant" tagid="citf3494s001rgi2sicjrgjyo">Pull-to-refresh<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Mask"><span class="tag-instant" tagid="citf3495b002xgi2s47ivzd66">Mask<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Network"><span class="tag-instant" tagid="citf3495j003lgi2stu6csj3h">Network<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/PC"><span class="tag-instant" tagid="citf3495l003ogi2sqqamm9hq">PC<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Paging"><span class="tag-instant" tagid="citf3495t0049gi2siph8dor1">Paging<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-qt" class="tags-selection-content-part"><a href="/tags/Sort"><span class="tag-instant" tagid="citf3495c0032gi2sh6aai34x">Sort<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Team Building"><span class="tag-instant" tagid="citf3495e0038gi2szn2p7y93">Team-Building<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Tooltips"><span class="tag-instant" tagid="citf3495o003ugi2sqwi8xoqw">Tooltips<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Textfield"><span class="tag-instant" tagid="citf3495o003wgi2sloq3iop2">Textfield<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Render"><span class="tag-instant" tagid="citf3495q0041gi2s1o8bs5jw">Render<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Selection"><span class="tag-instant" tagid="citf3495t0047gi2sqfd6hjtg">Selection<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/RadioButton"><span class="tag-instant" tagid="citf3495z004jgi2sd66vqed8">RadioButton<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-ux" class="tags-selection-content-part"><a href="/tags/Vue.js"><span class="tag-instant" tagid="citf34947000lgi2s1mu4lgdy">Vue-js<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-yz" class="tags-selection-content-part"></div></div>
  </div>
</section>
<article id="post-how-to-handle-the-loading-mask-automatically-in-extjs"  class=" ease-animation">
  <header class="article-header">
    
        
  
    <div class="article-title" itemprop="name">
      How to handle the loading mask automatically in ExtJS
    </div>
  

    
    <div class="article-meta sm-font">
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a><i class="fa fa-circle dot-separator"></i><a class="article-category-link" href="/categories/JavaScript/ExtJS/">ExtJS</a>
  </div>


      <a href="/2014/05/03/how-to-handle-the-loading-mask-automatically-in-extjs/" class="article-updated">
  <time datetime="2014-05-03T13:12:54.000Z" itemprop="datePublished">14/05/03 21:05</time>
</a>
    </div>
  </header>
  <div class="article-entry">
  
    <blockquote>
<p>We know that ajax asynchronous request is being used everywhere in most of the website.<br>But in some situations, other operations are not allowed to create before all the current requests finished.<br>So, if we send out at least 2 ajax requests at the same time.<br>How can we handle this mask layer in these mulit-requests situation?<br>Like show mask on time, hide the mask after all the requests finish</p>
</blockquote>
<h3 id="API_Document">API Document</h3><p>ExtJS has the existing Ajax class, usually, we can find some useful guide there, such as method, attribute, event…</p>
<p>After read the docs, three useful event listeners attracted our eyes. They are</p>
<ul>
<li>beforerequest</li>
<li>requestcomplete</li>
<li>requestexception</li>
</ul>
<p>In the entry of your web app, we should create one global variable (<strong>ajaxProcessingCount</strong>) to count the the total times of ajax request.<br>The counter plus one in the beforerequest event, minus one in the requestcomplete and requestexception event.<br>We should check the result of the counter whether it is 0 or not.</p>
<p>Well, here’s the source codes, we can add this code snippet to your entry file of the web site.<br><a id="more"></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ajaxProcessingCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">handleRequestError = <span class="function"><span class="keyword">function</span> (<span class="params">errorMessage</span>) </span>&#123;</span><br><span class="line">    Ext.getBody().unmask();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (Ext.Msg.isVisible()) &#123;</span><br><span class="line">        Ext.Msg.hide();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Ext.Ajax.on(<span class="string">'beforerequest'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">conn, options, eOpts</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> message = <span class="string">'Loading...'</span>;</span><br><span class="line"></span><br><span class="line">    ajaxProcessingCount += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (Ext.getBody()) &#123;</span><br><span class="line">        Ext.getBody().mask(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Ext.Ajax.on(<span class="string">'requestcomplete'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">conn, response, options, eOpts</span>) </span>&#123;</span><br><span class="line">    ajaxProcessingCount -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your code here...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ajaxProcessingCount === <span class="number">0</span> &amp;&amp; Ext.getBody()) &#123;</span><br><span class="line">        Ext.getBody().unmask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Ext.Ajax.on(<span class="string">'requestexception'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">conn, response, options, eOpts</span>) </span>&#123;</span><br><span class="line">    ajaxProcessingCount -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Your code here...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ajaxProcessingCount === <span class="number">0</span> &amp;&amp; Ext.getBody()) &#123;</span><br><span class="line">        Ext.getBody().unmask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
  
  </div>
  <footer class="article-footer">
    <div class="article-footer-left">
      <a href="hexo_post.html#disqus" class="article-footer-left"><span class="comments"><i class="fa fa-comments"></i> 0 Comment</span></a>
      <i class="fa fa-circle dot-separator"></i>
    </div>
    
  <ul class="ease-animation sm-font tag-list"><li class="ease-animation sm-font tag-list-item"><a class="ease-animation sm-font tag-list-link" href="/tags/Mask/">Mask</a></li></ul>

    <div class="article-footer-right">
    
      <a href="hexo_post.html"><span class="save-pocket button sm-font ease-animation"><i class="fa fa-share"></i> Share</span></a>
    </div>
  </footer>
</article>

  
<div class="link-to-article"> 
  <div class="link-to-article-next">
  
    
      <div class="article-nav-date">
        2014-04-30
      </div>
      <div class="article-nav-title">
        <a href="/2014/04/30/sorting-visualization-using-javascript/" title="Sorting Visualization using JavaScript">Sorting Visualization using JavaScript</a>
      </div>
     
  
  </div>
  <div class="link-to-article-separator">
    <i class="fa fa-circle dot-separator"></i>
  </div>
  <div class="link-to-article-prev">
  
    
      <div class="article-nav-date">
        2014-05-15
      </div>
      <div class="article-nav-title">
        <a href="/2014/05/15/create-2048-using-html5-canvas-play/" title="Create 2048 using HTML5 Canvas(Play)">Create 2048 using HTML5 Canvas(Play)</a>
      </div>
        
  
  </div>
</div>


</section>
      </div>
      <footer id="footer" class="site-footer">
	&copy; 2016 Daniel Zhu<br>
  <p>Theme by <a href="http://github.com/danielzhu" title="Line" target="_blank" rel="external">Line</a> Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="external">Hexo</a>
</footer>
    </div>
    


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>
<script src="/js/grouped_tag.js" type="text/javascript"></script>
  </div>
</body>
</html>
