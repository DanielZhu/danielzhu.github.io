<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>在AngularJs的项目中使用iScroll控件碰到的问题集合 | Xiaodan&#39;s Everything</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="背景这两天有在帮忙看一个项目，期间我们有碰到一个滚动列表的问题，还真有不少问题。
问题清单
列表初始化加载后，鼠标拖着它向上滚动，松开鼠标后，列表自动滚回到第一条，即无法滚动列表，并且不显示垂直滚动条。
拖动列表向上滚动，底部的“继续上拉刷新”和“松开加载更多”的提示语显示时机不正确。
在列表任意位置托拖动向上，都会去加载更多项目累加在最后，不符合逻辑。

调查解决作为被使用灰常广泛的iScrol">
<meta property="og:type" content="article">
<meta property="og:title" content="在AngularJs的项目中使用iScroll控件碰到的问题集合">
<meta property="og:url" content="http://blog.staydan.com/2014/07/29/using-iscroll-in-angularjs/index.html">
<meta property="og:site_name" content="Xiaodan's Everything">
<meta property="og:description" content="背景这两天有在帮忙看一个项目，期间我们有碰到一个滚动列表的问题，还真有不少问题。
问题清单
列表初始化加载后，鼠标拖着它向上滚动，松开鼠标后，列表自动滚回到第一条，即无法滚动列表，并且不显示垂直滚动条。
拖动列表向上滚动，底部的“继续上拉刷新”和“松开加载更多”的提示语显示时机不正确。
在列表任意位置托拖动向上，都会去加载更多项目累加在最后，不符合逻辑。

调查解决作为被使用灰常广泛的iScrol">
<meta property="og:updated_time" content="2016-01-30T06:24:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="在AngularJs的项目中使用iScroll控件碰到的问题集合">
<meta name="twitter:description" content="背景这两天有在帮忙看一个项目，期间我们有碰到一个滚动列表的问题，还真有不少问题。
问题清单
列表初始化加载后，鼠标拖着它向上滚动，松开鼠标后，列表自动滚回到第一条，即无法滚动列表，并且不显示垂直滚动条。
拖动列表向上滚动，底部的“继续上拉刷新”和“松开加载更多”的提示语显示时机不正确。
在列表任意位置托拖动向上，都会去加载更多项目累加在最后，不符合逻辑。

调查解决作为被使用灰常广泛的iScrol">
  
  
  <script src="http://www.staydan.com/libs/jQuery/2.0.3/jquery-2.0.3.min.js"></script>
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div class="container">
    <div class="wrapper">
      <header class="site-header">
  <div id="header-title" class="inner">
    <h1>
      <a href="/" title="Xiaodan's Everything">Xiaodan's Everything</a>
    </h1>
    
      <h4 id="subtitle-wrap">
        <a href="/" title="A foolish Programmer from Shanghai China">A foolish Programmer from Shanghai China</a>
      </h4>
    
  </div>
  <nav id="site-navs" class="">
	  <ul>
      <li class="header-underline"></li>
      
	      <li class="ease-animation"><a href="/" title="Home">Home</a></li>
	    
	      <li class="ease-animation"><a href="/archives" title="Archives">Archives</a></li>
	    
	      <li class="ease-animation"><a href="/about" title="About">About</a></li>
	    
	      <li class="ease-animation"><a href="/logs" title="Logs">Logs</a></li>
	    
	  </ul>
	  <div class="clearfix"></div>
	</nav>
</header>

      <div class="outer clearfix">
        <section id="main"><section class="tags-selection">
  <header class="tags-selection-header">
    <div class="tags-selection-header-label"><i class="fa fa-tag"></i>Tags</div>
  </header>
  <div id="tags-selection-panel">
  	<div class="tags-selection-navs" title="Sorted by the first English alphabet."><label class="tags-selection-nav active" navid="ad">A - D</label><label class="tags-selection-nav " navid="eh">E - H</label><label class="tags-selection-nav " navid="il">I - L</label><label class="tags-selection-nav " navid="mp">M - P</label><label class="tags-selection-nav " navid="qt">Q - T</label><label class="tags-selection-nav " navid="ux">U - X</label><label class="tags-selection-nav " navid="yz">Y - Z</label></div><div class="tags-selection-content"><div id="tags-selection-content-ad" class="tags-selection-content-part"><a href="/tags/Click Event"><span class="tag-instant" tagid="cik12capz000dcrwh7y9kejau">Click-Event<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Data Visualization"><span class="tag-instant" tagid="cik12caq2000jcrwhcko8k230">Data-Visualization<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/docing"><span class="tag-instant" tagid="cik12caqd0014crwhe3ra46k9">docing<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/document"><span class="tag-instant" tagid="cik12caqe0015crwhkd3bkws9">document<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/CSS3"><span class="tag-instant" tagid="cik12caqh001dcrwh3ifp0fmn">CSS3<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Canvas"><span class="tag-instant" tagid="cik12caqn001pcrwh48dc0jld">Canvas<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Algorithm"><span class="tag-instant" tagid="cik12caqs0023crwhgp3ogvuh">Algorithm<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/DateFormat"><span class="tag-instant" tagid="cik12carg003ecrwh7x0r7pfk">DateFormat<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/CSS"><span class="tag-instant" tagid="cik12carj003kcrwhjvfb0go1">CSS<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/AngularJS"><span class="tag-instant" tagid="cik12carp003tcrwh1cgu4pqs">AngularJS<sup class="tag-selection-badge">0</sup></span></a><a href="/tags/Bower"><span class="tag-instant" tagid="cik12carp003vcrwhuuf33s75">Bower<sup class="tag-selection-badge">0</sup></span></a></div><div id="tags-selection-content-eh" class="tags-selection-content-part"><a href="/tags/Hive Plot"><span class="tag-instant" tagid="cik12caq3000kcrwhohxqi02q">Hive-Plot<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/HTML5"><span class="tag-instant" tagid="cik12caqh001ccrwhfb53plsw">HTML5<sup class="tag-selection-badge">2</sup></span></a><a href="/tags/History"><span class="tag-instant" tagid="cik12carm003pcrwh7nze94br">History<sup class="tag-selection-badge">0</sup></span></a><a href="/tags/Grunt"><span class="tag-instant" tagid="cik12carp003ucrwhbwi68yg8">Grunt<sup class="tag-selection-badge">0</sup></span></a></div><div id="tags-selection-content-il" class="tags-selection-content-part"><a href="/tags/JavaScript"><span class="tag-instant" tagid="cik12capt0004crwhbzrpm7ct">JavaScript<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/jQuery"><span class="tag-instant" tagid="cik12capv0005crwhjy68a4cr">jQuery<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/iScrollJs"><span class="tag-instant" tagid="cik12caq9000ycrwhi2bb7zr9">iScrollJs<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Jeju"><span class="tag-instant" tagid="cik12caqz002fcrwh40p8273n">Jeju<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/laptop"><span class="tag-instant" tagid="cik12car3002mcrwhr9inucmy">laptop<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-mp" class="tags-selection-content-part"><a href="/tags/Pull to refresh"><span class="tag-instant" tagid="cik12caq7000rcrwh8ba6qxa0">Pull-to-refresh<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Mask"><span class="tag-instant" tagid="cik12caqq001xcrwh9z8rxwcl">Mask<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Network"><span class="tag-instant" tagid="cik12car3002lcrwhfcol1lzn">Network<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/PC"><span class="tag-instant" tagid="cik12car3002ocrwho1ii0fhh">PC<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Paging"><span class="tag-instant" tagid="cik12care0039crwhcz5jwgej">Paging<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-qt" class="tags-selection-content-part"><a href="/tags/Sort"><span class="tag-instant" tagid="cik12caqs0022crwhpmxt5ron">Sort<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Team Building"><span class="tag-instant" tagid="cik12caqv0028crwh44gnfow1">Team-Building<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Tooltips"><span class="tag-instant" tagid="cik12car6002ucrwhcf7tmm7t">Tooltips<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Textfield"><span class="tag-instant" tagid="cik12car7002wcrwhaw02k8xy">Textfield<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Render"><span class="tag-instant" tagid="cik12car90031crwhplr2gwdz">Render<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/Selection"><span class="tag-instant" tagid="cik12card0037crwhey3vwqrj">Selection<sup class="tag-selection-badge">1</sup></span></a><a href="/tags/RadioButton"><span class="tag-instant" tagid="cik12cari003jcrwhbr7linev">RadioButton<sup class="tag-selection-badge">1</sup></span></a></div><div id="tags-selection-content-ux" class="tags-selection-content-part"></div><div id="tags-selection-content-yz" class="tags-selection-content-part"></div></div>
  </div>
</section>
<article id="post-using-iscroll-in-angularjs"  class=" ease-animation">
  <header class="article-header">
    
        
  
    <div class="article-title" itemprop="name">
      在AngularJs的项目中使用iScroll控件碰到的问题集合
    </div>
  

    
    <div class="article-meta sm-font">
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a><i class="fa fa-circle dot-separator"></i><a class="article-category-link" href="/categories/JavaScript/AngularJS/">AngularJS</a>
  </div>


      <a href="/2014/07/29/using-iscroll-in-angularjs/" class="article-updated">
  <time datetime="2014-07-29T14:11:31.000Z" itemprop="datePublished">14/07/29 22:07</time>
</a>
    </div>
  </header>
  <div class="article-entry">
  
    <h2 id="背景">背景</h2><p>这两天有在帮忙看一个项目，期间我们有碰到一个滚动列表的问题，还真有不少问题。</p>
<h3 id="问题清单">问题清单</h3><ol>
<li>列表初始化加载后，鼠标拖着它向上滚动，松开鼠标后，列表自动滚回到第一条，即无法滚动列表，并且不显示垂直滚动条。</li>
<li>拖动列表向上滚动，底部的“继续上拉刷新”和“松开加载更多”的提示语显示时机不正确。</li>
<li>在列表任意位置托拖动向上，都会去加载更多项目累加在最后，不符合逻辑。</li>
</ol>
<h3 id="调查解决">调查解决</h3><p>作为被使用灰常广泛的iScroll列表滚动插件，没想到被整合进来后悔遇到这么多问题</p>
<ul>
<li>第一个问题  <strong>加载时机</strong></li>
</ul>
<a id="more"></a>
<blockquote>
<p>The iScroll needs to be initiated when the DOM is ready. The safest bet is to start it on window onload event. DOMContentLoaded or inline initialization are also fine but remember that the script needs to know the height/width of the scrolling area. If you have images that don’t have explicit width/height declaration, iScroll will most likely end up with a wrong scroller size.<br>  在iScroll 5的官网上，作者有提到使用iScroll的前提是在Dom全部加载完成后，而我们遇到的问题正是因为没有做到这一点，所以修复的方法得在Dom加载完成后初始化iScroll。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">angular.element(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// Set 200 delay to make sure Dom is ready</span></span><br><span class="line">	setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    initScroll();</span><br><span class="line">	&#125;, <span class="number">200</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li><p>第二个问题 <strong>初始化错误</strong></p>
<p>  在<a href="iscroll-website">官网</a>上寻找了下iScoll实例化后各个属性的含义，可惜没找到，所以只能在实际项目和例子中摸索他们所代表的含义。</p>
<p>  <em>maxScrollY</em>: 可以垂直滚动的最大距离<br>  <em>minScrollY</em>: 可以垂直滚动的最小距离<br>  <em>startX</em>: 滚动条滚动的起始X坐标值<br>  <em>startY</em>: 滚动条滚动的起始Y坐标值<br>  <em>x</em>: 当前滚动条的x坐标<br>  <em>y</em>: 当前滚动条的y坐标</p>
<p>  在经过调试后，发现 <figure class="highlight"><figcaption><span>在鼠标拖动列表上拉到显示出刷新提示语后，数值不正确。导致显示“继续上拉刷新”和“松开加载更多”的显示时机错乱，几乎看不到前面那条提示语出现。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;&#9;&#27880;&#37322;&#25481; ```this.maxScrollY = pullUpOffset``` &#21518;&#65292;&#19968;&#20999;&#24674;&#22797;&#27491;&#24120;&#12290;&#10;&#10;- &#31532;&#19977;&#20010;&#38382;&#39064; **iScroll&#24037;&#20316;&#26426;&#21046;**&#10;&#10;&#9;&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#65292;&#22312;&#19978;&#25289;&#21518;&#37322;&#25918;&#65292;&#31243;&#24207;&#20250;&#21435;&#36828;&#31243;&#25289;&#21462;&#26032;&#25968;&#25454;&#65292;&#28982;&#21518;&#32047;&#21152;&#22312;&#21015;&#34920;&#23614;&#37096;&#26174;&#31034;&#65292;&#21516;&#26102;&#26356;&#26032;&#28378;&#21160;&#26465;&#65292;&#20294;&#26159;&#65281;&#65281;&#65281;&#65281;&#20854;&#20182;&#37117;&#27491;&#24120;&#65292;&#21807;&#29420;&#28378;&#21160;&#26465;&#19981;&#26356;&#26032;&#65292;&#25152;&#20197;&#23548;&#33268;&#20102;&#19968;&#27425;&#19978;&#25289;&#26356;&#26032;&#21518;&#65292;&#20877;&#20063;&#19981;&#33021;&#32487;&#32493;&#24448;&#19978;&#25289;&#20102;&#12290;&#10;&#10;&#9;iScroll&#20316;&#32773;&#24314;&#35758;&#22312;&#27599;&#27425;&#26356;&#26032;&#25968;&#25454;&#21518;&#65292;&#35201;&#35843;&#29992; ```refresh()``` &#26041;&#27861;&#26469;&#21047;&#26032;&#21015;&#34920;&#65292;&#31561;&#21516;&#20110;&#35753;iScroll&#33258;&#36523;&#37325;&#26032;&#35745;&#31639;&#21508;&#39033;&#25968;&#20540;&#12290;&#10;&#10;&#9;&#25152;&#20197;&#22312;&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#65292;&#35843;&#29992; ```refresh()``` &#30340;&#26102;&#26426;&#19981;&#23545;&#65292;&#22240;&#20026; ```getListData()``` &#23646;&#20110;&#24322;&#27493;&#26041;&#27861;&#65292;&#25152;&#20197;&#24517;&#39035;&#35201;&#22312;&#22238;&#35843;&#26041;&#27861;&#37324;&#25191;&#34892; ```refresh()```&#12290;&#10;&#10;``` JavaScript&#10;function pullDownAction () &#123;&#10;  setTimeout(function () &#123;  // &#60;-- Simulate network congestion, remove setTimeout from production!&#10;    getListData(0, 10);&#10;    console.log(&#34;pullDownAction is called...&#34;);&#10;&#10;    myScroll.refresh();   // Remember to refresh when contents are loaded (ie: on ajax completion)&#10;  &#125;, 1000); // &#60;-- Simulate network congestion, remove setTimeout from production!&#10;&#125;&#10;&#10;function pullUpAction () &#123;&#10;  setTimeout(function () &#123;  // &#60;-- Simulate network congestion, remove setTimeout from production!&#10;    getListData(start, end);&#10;    console.log(&#34;pullUpAction is called...&#34;);&#10;&#10;    myScroll.refresh();   // Remember to refresh when contents are loaded (ie: on ajax completion)&#10;  &#125;, 1000); // &#60;-- Simulate network congestion, remove setTimeout from production!&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>  所以最后能正常工作的版本如下：</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Define the scroll first</span></span><br><span class="line"><span class="keyword">var</span> myScroll = <span class="literal">null</span>,</span><br><span class="line">     pullDownEl, pullDownOffset,</span><br><span class="line">     pullUpEl, pullUpOffset,</span><br><span class="line">     generatedCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// Retrieve the list as soon as the Dom ready</span></span><br><span class="line"> angular.element(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       getListData(start, end);</span><br><span class="line">   &#125;, <span class="number">200</span>);</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getListData</span>(<span class="params">start, end</span>) </span>&#123;</span><br><span class="line">   $scope.activities = [];</span><br><span class="line">   demoService.filterListData(start, end)</span><br><span class="line">     .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">       $scope.list = response;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// In the callback, create the iScroll if it's null</span></span><br><span class="line">       <span class="keyword">if</span> (myScroll === <span class="literal">null</span>) &#123;</span><br><span class="line">         createScroll();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Remember to refresh when contents are loaded (ie: on ajax completion)</span></span><br><span class="line">       <span class="comment">// After pull down of pull up the list, it should do refresh after the content has been displayed on the view.</span></span><br><span class="line">       <span class="comment">// Otherwise, the maxScrollY will be wrong within the iscroll.</span></span><br><span class="line">       setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;myScroll.refresh()&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">   &#125;);</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">createScroll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   pullDownEl = <span class="built_in">document</span>.getElementById(<span class="string">'pullDown'</span>);</span><br><span class="line">   pullDownOffset = pullDownEl.offsetHeight;</span><br><span class="line">   pullUpEl = <span class="built_in">document</span>.getElementById(<span class="string">'pullUp'</span>);</span><br><span class="line">   pullUpOffset = pullUpEl.offsetHeight;</span><br><span class="line"></span><br><span class="line">   myScroll = <span class="keyword">new</span> iScroll(<span class="string">'wrapper'</span>, &#123;</span><br><span class="line">     useTransition: <span class="literal">true</span>,</span><br><span class="line">     topOffset: pullDownOffset,</span><br><span class="line">     vScrollbar: <span class="literal">true</span>,</span><br><span class="line">     onRefresh: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (pullDownEl.className.match(<span class="string">'loading'</span>)) &#123;</span><br><span class="line">         pullDownEl.className = <span class="string">''</span>;</span><br><span class="line">         pullDownEl.querySelector(<span class="string">'.pullDownLabel'</span>).innerHTML = <span class="string">'Pull down to refresh...'</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pullUpEl.className.match(<span class="string">'loading'</span>)) &#123;</span><br><span class="line">         pullUpEl.className = <span class="string">''</span>;</span><br><span class="line">         pullUpEl.querySelector(<span class="string">'.pullUpLabel'</span>).innerHTML = <span class="string">'Pull up to load more...'</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     onScrollMove: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">this</span>.y &gt; <span class="number">20</span> &amp;&amp; !pullDownEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullDownEl.className = <span class="string">'flip'</span>;</span><br><span class="line">         pullDownEl.querySelector(<span class="string">'.pullDownLabel'</span>).innerHTML = <span class="string">'Release to refresh...'</span>;</span><br><span class="line">         <span class="keyword">this</span>.minScrollY = <span class="number">0</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.y &lt; <span class="number">20</span> &amp;&amp; pullDownEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullDownEl.className = <span class="string">''</span>;</span><br><span class="line">         pullDownEl.querySelector(<span class="string">'.pullDownLabel'</span>).innerHTML = <span class="string">'Pull down to refresh...'</span>;</span><br><span class="line">         <span class="keyword">this</span>.minScrollY = -pullDownOffset;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.y &lt; (<span class="keyword">this</span>.maxScrollY - <span class="number">5</span>) &amp;&amp; !pullUpEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullUpEl.className = <span class="string">'flip'</span>;</span><br><span class="line">         pullUpEl.querySelector(<span class="string">'.pullUpLabel'</span>).innerHTML = <span class="string">'Release to refresh...'</span>;</span><br><span class="line">         <span class="keyword">this</span>.maxScrollY = <span class="keyword">this</span>.maxScrollY;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.y &gt; (<span class="keyword">this</span>.maxScrollY + <span class="number">5</span>) &amp;&amp; pullUpEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullUpEl.className = <span class="string">''</span>;</span><br><span class="line">         pullUpEl.querySelector(<span class="string">'.pullUpLabel'</span>).innerHTML = <span class="string">'Pull up to load more...'</span>;</span><br><span class="line">         <span class="comment">// this.maxScrollY = pullUpOffset;</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     onScrollEnd: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (pullDownEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullDownEl.className = <span class="string">'loading'</span>;</span><br><span class="line">         pullDownEl.querySelector(<span class="string">'.pullDownLabel'</span>).innerHTML = <span class="string">'Loading...'</span>;</span><br><span class="line">         pullDownAction(); <span class="comment">// Execute custom function (ajax call?)</span></span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pullUpEl.className.match(<span class="string">'flip'</span>)) &#123;</span><br><span class="line">         pullUpEl.className = <span class="string">'loading'</span>;</span><br><span class="line">         pullUpEl.querySelector(<span class="string">'.pullUpLabel'</span>).innerHTML = <span class="string">'Loading...'</span>;</span><br><span class="line">         pullUpAction(); <span class="comment">// Execute custom function (ajax call?)</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">document</span>.getElementById(<span class="string">'wrapper'</span>).style.left = <span class="string">'0'</span>; &#125;, <span class="number">800</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pullDownAction</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  <span class="comment">// &lt;-- Simulate network congestion, remove setTimeout from production!</span></span><br><span class="line">    getListData(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"pullDownAction is called..."</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// myScroll.refresh();   // Remember to refresh when contents are loaded (ie: on ajax completion)</span></span><br><span class="line">  &#125;, <span class="number">1000</span>); <span class="comment">// &lt;-- Simulate network congestion, remove setTimeout from production!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pullUpAction</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  <span class="comment">// &lt;-- Simulate network congestion, remove setTimeout from production!</span></span><br><span class="line">    getListData(start, end);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"pullUpAction is called..."</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// myScroll.refresh();   // Remember to refresh when contents are loaded (ie: on ajax completion)</span></span><br><span class="line">  &#125;, <span class="number">1000</span>); <span class="comment">// &lt;-- Simulate network congestion, remove setTimeout from production!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  
  </div>
  <footer class="article-footer">
    <div class="article-footer-left">
      <a href="hexo_post.html#disqus" class="article-footer-left"><span class="comments"><i class="fa fa-comments"></i> 0 Comment</span></a>
      <i class="fa fa-circle dot-separator"></i>
    </div>
    
  <ul class="ease-animation sm-font tag-list"><li class="ease-animation sm-font tag-list-item"><a class="ease-animation sm-font tag-list-link" href="/tags/iScrollJs/">iScrollJs</a></li></ul>

    <div class="article-footer-right">
    
      <a href="hexo_post.html"><span class="save-pocket button sm-font ease-animation"><i class="fa fa-share"></i> Share</span></a>
    </div>
  </footer>
</article>

  
<div class="link-to-article"> 
  <div class="link-to-article-next">
  
    
      <div class="article-nav-date">
        2014-07-19
      </div>
      <div class="article-nav-title">
        <a href="/2014/07/19/docing-a-new-document-generator-for-all-programming-languages/" title="Docing - A new document generator for all programming languages">Docing - A new document generator for all programming languages</a>
      </div>
     
  
  </div>
  <div class="link-to-article-separator">
    <i class="fa fa-circle dot-separator"></i>
  </div>
  <div class="link-to-article-prev">
  
    
      <div class="article-nav-date">
        2014-07-31
      </div>
      <div class="article-nav-title">
        <a href="/2014/07/31/customized-pull-to-refresh-list-using-iscroll/" title="Customized Pull To Refresh List Using iScroll">Customized Pull To Refresh List Using iScroll</a>
      </div>
        
  
  </div>
</div>


</section>
      </div>
      <footer id="footer" class="site-footer">
	&copy; 2016 Daniel Zhu<br>
  <p>Theme by <a href="http://github.com/danielzhu" title="Line" target="_blank" rel="external">Line</a> Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="external">Hexo</a>
</footer>
    </div>
    


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>
<script src="/js/grouped_tag.js" type="text/javascript"></script>
  </div>
</body>
</html>
